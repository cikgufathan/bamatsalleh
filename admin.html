<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Arabic Merit</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #0f172a; color: #f8fafc; font-family: sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { max-width: 400px; width: 100%; }
        
        /* Login */
        #login-box { text-align: center; margin-top: 50px; }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #334155; background: #1e293b; color: white; font-size: 1rem; box-sizing: border-box;}
        button { background: #3b82f6; border: none; font-weight: bold; cursor: pointer; }
        button:hover { background: #2563eb; }
        .btn-del { background: #ef4444; margin-top: 5px; }
        
        /* Panel */
        #panel { display: none; }
        .card { background: #1e293b; padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #334155; }
        h2 { margin-top: 0; color: #3b82f6; }
        label { font-size: 0.8rem; color: #94a3b8; font-weight: bold; }
        
        /* Toast */
        #toast { visibility: hidden; min-width: 250px; background-color: #10b981; color: #fff; text-align: center; border-radius: 50px; padding: 16px; position: fixed; z-index: 1; bottom: 30px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>

<div class="container">
    <div id="login-box">
        <h1>ADMIN ACCESS</h1>
        <input type="password" id="pass" placeholder="Masukkan Password">
        <button onclick="login()">LOGIN</button>
    </div>

    <div id="panel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h1 style="margin:0;">Dashboard</h1>
            <button onclick="logout()" style="width:auto; background:#475569; font-size:0.8rem;">Logout</button>
        </div>

        <div class="card">
            <h2><i class="fas fa-user-edit"></i> Kemaskini Markah</h2>
            <label>NAMA PELAJAR</label>
            <input type="text" id="pName" placeholder="Contoh: Ahmad Ali">
            
            <label>KELAS</label>
            <select id="pClass">
                <option value="1 AL-RAZI">1 AL-RAZI</option>
                <option value="1 AL-FARABI">1 AL-FARABI</option>
                <option value="2 IBNU SINA">2 IBNU SINA</option>
                <option value="2 IBNU KHALDUN">2 IBNU KHALDUN</option>
            </select>
            
            <label>JUMLAH MARKAH BARU</label>
            <input type="number" id="pScore" placeholder="Contoh: 50">
            
            <button onclick="submitData('update')">SIMPAN DATA</button>
        </div>

        <div class="card" style="border-color:#7f1d1d;">
            <h2 style="color:#ef4444;"><i class="fas fa-trash"></i> Padam Pelajar</h2>
            <label>NAMA PELAJAR (Mesti Tepat)</label>
            <input type="text" id="dName" placeholder="Nama untuk dipadam...">
            <button class="btn-del" onclick="submitData('delete')">PADAM REKOD</button>
        </div>
    </div>
</div>

<div id="toast">Berjaya disimpan!</div>

<script>
    // --- LINK SCRIPT TUAN (AUTOMATIK) ---
    const API_URL = "https://script.google.com/macros/s/AKfycbwJgeiE56ZauzhO9MMWOPKVIsaXuD8QvK1b6-n4RswZLNZ3M82GvDOikHU_gtCuS4R3/exec";

    function login() {
        const p = document.getElementById('pass').value;
        if(p === "admin123") { // Password Cikgu
            document.getElementById('login-box').style.display = 'none';
            document.getElementById('panel').style.display = 'block';
        } else {
            alert("Password Salah!");
        }
    }

    function logout() { location.reload(); }

    function submitData(action) {
        const btn = document.querySelector('button');
        const origText = btn.innerText;
        btn.innerText = "Processing...";
        btn.disabled = true;

        let data = {};
        
        if(action === 'update') {
            const name = document.getElementById('pName').value.trim().toUpperCase(); 
            const cls = document.getElementById('pClass').value;
            const score = document.getElementById('pScore').value;
            if(!name || !score) { alert("Sila isi semua info!"); btn.disabled=false; btn.innerText=origText; return; }
            data = { action: "add", name: name, class: cls, score: score };
        } 
        else if(action === 'delete') {
            const name = document.getElementById('dName').value.trim().toUpperCase();
            if(!name) { alert("Isi nama dulu!"); btn.disabled=false; btn.innerText=origText; return; }
            if(!confirm("Betul nak padam " + name + "?")) { btn.disabled=false; btn.innerText=origText; return; }
            data = { action: "delete", name: name };
        }

        fetch(API_URL, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        }).then(() => {
            showToast(action === 'delete' ? "Rekod Dipadam!" : "Markah Disimpan!");
            // Clear input fields
            document.getElementById('pName').value = '';
            document.getElementById('pScore').value = '';
            document.getElementById('dName').value = '';
            btn.disabled = false;
            btn.innerText = origText;
        }).catch(err => {
            alert("Error: " + err);
            btn.disabled = false;
            btn.innerText = origText;
        });
    }

    function showToast(msg) {
        const x = document.getElementById("toast");
        x.innerText = msg;
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }
</script>

</body>
</html>
